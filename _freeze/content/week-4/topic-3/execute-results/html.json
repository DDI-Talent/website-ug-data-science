{
  "hash": "1c9d3c791e9575017350258516d91603",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Topic 3: Roundup and recap\"\nformat: html\n---\n\n## Reproducibility in R\n\nAt the beginning of this course we introduced R by highlighting one of its main attractions: reproducibility. And here we are at the end of the course still banging on about reproducibility, but that's because it is so important.\n\nThere is a growing awareness of the importance of reproducibility in data processing and analysis, and thankfully the tools needed to generate reproducible outputs are more accessible than ever before, helping to make this easier to accomplish.\n\nThere are many ways in which you can ensure your work is reproducible. The first we would recommend, is to start using R, and the second is to become familiar with R Markdown, so you are well on your way!\n\nHere is a reminder of some of the main points to bear in mind, to ensure your future self and others can easily and efficiently build on the analysis you have carried out in R:\n\n-   always create an RStudio **Project** to work in\n\n-   use **raw data** directly in R (no pre-editing with other software)\n\n-   include informative **commenting**\n\n-   ensure code is **easy to read** with appropriate indentations and spacing\n\n-   pipe %\\>% with the **Tidyverse**\n\n-   give your objects **meaningful names**\n\n-   work in **R Markdown** for reporting\n\nLet's look at these aspects in little more detail.\n\n![](images/week4.3.rproj.PNG.png){fig-align=\"center\" width=\"222\"}\n\nBy now you should be familiar with the how and the why of creating **Projects** in RStudio as this has cropped up frequently throughout the course. Projects help to keep everything in one place, they help R to find all your files and folders easily, and they generally make your life a lot easier so you should definitely be using them.\n\n![](images/week4.3.rawdata.jpg){fig-align=\"center\"}\n\nAlways use the **raw data**. If your data has come from a database or from a publicly updated data source, avoid the temptation of doing some quick and dirty data wrangling in Excel before importing into R. This would make your analysis less reproducible as you may not always remember exactly what steps you took during this initial phase and these steps would then need to be taken each time you wanted to repeat or carry out a similar operation.\n\n![](images/week4.3.hash.png){fig-align=\"center\"}\n\nCode which is easy to decipher and understand can be revisited in the future and rerun more easily, but how many times have you looked back at scribbled notes you took in haste, or code you typed quickly, with no recollection of what it all means? By including informative **commenting** you can help your future self, or anyone else who might be looking at your code, understand what it is you were trying to do at each point in your script. It isn't needed for all lines of code but should be used when there might be ambiguity, or to provide clarification, or remind yourself about something specific to do with what's happening. The keyboard shortcut for commenting/uncommenting a line is **Ctrl+Shift+C**, or you can manually type \\# .\n\n![](images/easyread.svg){fig-align=\"center\" width=\"271\"}\n\nOn a similar theme, it is important to make your code **easy to read** by applying the appropriate indentations and spacing. The keyboard shortcut for quickly reformatting your code is **Ctrl+I** (first select your code, or use Ctrl+A to select all before doing Ctrl+I). If your script is long this is particularly important as it means you, or someone else, can scan the document more easily to find the relevant text or information.\n\n![](images/week4.3.tidyverse.png){fig-align=\"center\" width=\"271\"}\n\nThe **Tidyverse** has featured heavily in this course and is another great way to make your code easier to read and understand due to the use of the %\\>% operator. As we learned at the beginning of the course, the %\\>% reduces the need for nested functions, where each function is \"nested\" inside another making it potentially very difficult to debug. Instead the piped ( %\\>% ) functions appear almost like a series of statements or instructions, which can be run line by line if needed. At the start of every R script or document, remember to include library(tidyverse) .\n\n![](images/week4.3.headscratch.gif){fig-align=\"center\" width=\"145\"}\n\nTo finish, just a final note about assigning your objects **meaningful names**. This is easily overlooked and can be surprisingly difficult but when given careful consideration, good object naming can make your life a lot easier, and again, make the code easier to understand and read. Avoid generic names such as data or plot as these can cause problems. This is particularly true if you are carrying out multiple analyses and have referred to \"data\" or \"plot\" somewhere else and not cleared your environment (Restart R often!). Also, when choosing names, no spaces or funky characters, stick to lowercase with underscores. Then be consistent, and you should be safe!\n\n![](images/week4.3.rmarkdown.png){fig-align=\"center\" width=\"201\"}\n\nR Markdown is one of the keys to producing reproducible analysis in R as it enables the code and the narrative to be easily combined, whilst providing great flexibility as to how the output might be displayed. It is certainly worth the effort becoming familiar with R Markdown which was covered in detail in Week 6: Topics 1 & 2. Creating a new R Markdown document is as simple as going to File - New File - R Markdown - OK then delete everything up to the first code chunk (it is useful to leave the first setup chunk) and you are ready to go!\n\n### Reporting with R Markdown\n\nR Markdown is not only a powerful tool for ensuring reproducibility, but as you have already discovered, it includes many features which make it easy to create and share clear and professional looking documents for a wide range of audiences.\n\nHere are some things to remember when planning and designing a report with R Markdown:\n\n-   provide a clear **structure** using Markdown section headers (#, ##, ###)\n\n-   be conscious of the **YAML**, unlike R code, the YAML is very sensitive of extra spaces/formatting\n\n-   consider the **code output** options depending on audience (\\`echo = TRUE\\` vs \\`echo = FALSE\\`)\n\n-   think about the **story** you are trying to tell\n\n-   make good use of **figures**\n\n-   use **tables** appropriately\n\n![](images/paste-70B75AA2.png){fig-align=\"center\" width=\"487\"}\n\nIt is important to provide a clear **structure** in any report or document you are writing and R Markdown makes it easy to manage and display the structure through the use of headers. The hash symbol ( \\# ) is used in the Markdown sections (all the bits which aren't code chunks or YAML) to indicate different levels of header, so how big or small the text should be. These headers also show up in the document outline which is extremely useful as a means of navigating your document when editing, helping to save you time.\n\n\n\nThe **structure** of your R code chunks is important too. For example, it is good practice to have a code chunk near the top of your document (often in the setup chunk) where you keep all the packages that you are using together. It might look something like the image on the right. The next code chunk is often where you might choose to load your data and is likely to include the code similar to: mydata \\<- read_csv(here(\"data\", \"appointments.csv\"))\n\n![](images/paste-7B81FE24.png){fig-align=\"center\"}\n\nWe've already mentioned that Markdown headers ( \\# ) make it easy to define a clear structure in your R Markdown document. Explore some of the other **Markdown features**, such as **\\*\\*bold\\*\\*** and *\\*italic\\** or \\`inline R code\\`, which can help to give your final document a high quality finish. Remember, you can access the **Markdown Quick Reference** guide from the Help menu.\n\nIn its most basic form, the **YAML** which appears at the top of your R Markdown document, could simply tell R Markdown what output format you would like your document to be in, in which case it would look like this, indicating HTML output:\n\n```         \n---\noutput: html_document\n---\n```\n\n![](images/paste-40587EA3.png){fig-align=\"center\" width=\"271\"}\n\nHowever, you have the potential to add many attractive features via the **YAML**, such as table of contents, section numbering, themes, and much more. You have to be particularly careful about indentation in the YAML (unlike in R code chunks where indentation is mainly for readability) but you can start exploring YAML options easily through changing settings in the document cog and this will automatically update your YAML.\n\nDepending on who your intended audience is, you have a number of output options available to you. You can choose whether or not to **show or run your code** in the final document. Showing you code in the Markdown output document (HTML, Word, PDF) is denoted \\`echo = TRUE\\`, not showing it is denoted \\`echo = FALSE\\`. You also have control over whether to display the output of each code chunk or not too. These options can be accessed from the individual code chunk cogs or can be set for the whole document in the setup chunk.\n\n![](images/paste-3FCC498F.png){fig-align=\"center\" width=\"500\"}\n\nWhen creating a report or document, think about what **story** you are trying to tell with the data; you might be answering a specific question or perhaps highlighting a change in activity over a period of time. R Markdown makes it easy to intersperse clear and informative visual elements throughout the narrative. These could be in the form of figures and plots, nicely formatted tables or even images (e.g. JPG or PNG).\n\nWhen writing the code to produce a **plot**, remember you don't need to assign it to an object. For example, running myplot \\<- mydata %\\>% ggplot() will result in no plot appearing in your final document, it is saved in the Environment. Instead you can simply write mydata %\\>% ggplot() which will ensure your plot does appear. You can also control the size of your plots and figures in the code chunk settings cog.\n\nWhen writing the code for a **table** which you want to include in your final document, remember that the function kable() in the knitr package helps provide consistent table formatting across various different outputs. Also note that the same principles apply concerning whether or not your table output will appear as those referred to in plotting; no need to save the table first, you can simply write mydata %\\>% kable() .\n\nAnd finally, as addictive as it is creating beautiful plots with ggplot2, try not to bombard the reader with too many tables and figures. Choose wisely the information you would like to display in order to tell your story concisely and make good use of ggplot2's ability to provide a breadth of information in one plot, through careful use of aesthetic mappings.\n\n### Function recap\n\nIn this course we have covered a whole variety of functions which you will find useful when carrying out data wrangling, plotting and analysis in R. There are however some functions which you will find yourself using more frequently than others and in the following sections we provide a quick recap on some of these more common functions.\n\nThe examples below are intended as a quick reference guide to remind yourself which functions to use in which settings. They can be copied and pasted straight into an R Markdown document as code chunk to test, but if you are copying multiple code chunks, you only need to include the packages once.\n\n*Note: The examples below all use the gapminder dataset which is loaded by running the command library(gapminder) . In your own projects you would load your data with the command read_csv(\"mydata.csv\") or similar, depending on the format and location of your data.*\n\n#### **`distinct()`**\n\n**distinct() returns only distinct (unique) rows in a data frame**\n\nIn the example below we have included the variable continent so that we can explore how many unique categories there are in this column.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gapminder)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'gapminder' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code}\ngapminder %>%\n  distinct(continent)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 1\n  continent\n  <fct>    \n1 Asia     \n2 Europe   \n3 Africa   \n4 Americas \n5 Oceania  \n```\n\n\n:::\n:::\n\n\nUseful for:\n\n-   exploring categories\n\n-   spotting spelling mistakes\n\n-   looking at date ranges\n\n-   removing duplicate rows\n\n-   Try this out:\n\n```         \ngapminder %>%\ncount(contintent)\n```\n\n#### **`filter()`**\n\n**filter() returns a subset of rows based on a condition**\n\nIn the example below we have specified that we only want to see results where country is equal to Ghana .\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngapminder %>%\n  filter(country == \"Ghana\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 12 × 6\n   country continent  year lifeExp      pop gdpPercap\n   <fct>   <fct>     <int>   <dbl>    <int>     <dbl>\n 1 Ghana   Africa     1952    43.1  5581001      911.\n 2 Ghana   Africa     1957    44.8  6391288     1044.\n 3 Ghana   Africa     1962    46.5  7355248     1190.\n 4 Ghana   Africa     1967    48.1  8490213     1126.\n 5 Ghana   Africa     1972    49.9  9354120     1178.\n 6 Ghana   Africa     1977    51.8 10538093      993.\n 7 Ghana   Africa     1982    53.7 11400338      876.\n 8 Ghana   Africa     1987    55.7 14168101      847.\n 9 Ghana   Africa     1992    57.5 16278738      925.\n10 Ghana   Africa     1997    58.6 18418288     1005.\n11 Ghana   Africa     2002    58.5 20550751     1112.\n12 Ghana   Africa     2007    60.0 22873338     1328.\n```\n\n\n:::\n:::\n\n\nUseful for:\n\n-   filtering your data to remove unwanted rows\n\n-   filtering your data as part of the exploratory phase\n\n-   filtering your data prior to piping into ggplot()\n\nRemember:\n\n-   the \"equal to\" comparison operator needs double ==\n\n-   to use inverted commas (\"\") for non-numbers\n\n#### **`seselect()`**\n\n**select() lets you choose which columns to select**\n\nIn the example below we have chosen to select only 4 variables from our dataset and we have also changed the order in which they appear.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngapminder %>%\n  select(country, year, pop, lifeExp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1,704 × 4\n   country      year      pop lifeExp\n   <fct>       <int>    <int>   <dbl>\n 1 Afghanistan  1952  8425333    28.8\n 2 Afghanistan  1957  9240934    30.3\n 3 Afghanistan  1962 10267083    32.0\n 4 Afghanistan  1967 11537966    34.0\n 5 Afghanistan  1972 13079460    36.1\n 6 Afghanistan  1977 14880372    38.4\n 7 Afghanistan  1982 12881816    39.9\n 8 Afghanistan  1987 13867957    40.8\n 9 Afghanistan  1992 16317921    41.7\n10 Afghanistan  1997 22227415    41.8\n# ℹ 1,694 more rows\n```\n\n\n:::\n:::\n\n\nUseful for:\n\n-   removing unwanted columns (e.g. columns with NAs, or things you're just not going to use)\n\n-   focusing on selected columns for further exploration\n\n-   re-ordering columns for ease of viewing\n\n-   select() can also be used to rename columns, e.g.\n\n```         \ngapminder %>% \n  select(country, year, population = pop, life_expectancy = lifeExp)\n```\n\n-   And select() has a sister function called rename(), that can be used to rename columns without removing the ones you don't list, e.g.:\n\n```         \ngapminder %>%\n  rename(population = pop, life_expectancy = lifeExp)\n```\n\n#### **`mutate()`**\n\n**mutate() allows you to add a column or update an existing column**\n\nIn the example below we have created a new column called pop_millions so that we can display the population as a decimal number of millions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngapminder %>%\n  mutate(pop_millions = pop/1000000)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1,704 × 7\n   country     continent  year lifeExp      pop gdpPercap pop_millions\n   <fct>       <fct>     <int>   <dbl>    <int>     <dbl>        <dbl>\n 1 Afghanistan Asia       1952    28.8  8425333      779.         8.43\n 2 Afghanistan Asia       1957    30.3  9240934      821.         9.24\n 3 Afghanistan Asia       1962    32.0 10267083      853.        10.3 \n 4 Afghanistan Asia       1967    34.0 11537966      836.        11.5 \n 5 Afghanistan Asia       1972    36.1 13079460      740.        13.1 \n 6 Afghanistan Asia       1977    38.4 14880372      786.        14.9 \n 7 Afghanistan Asia       1982    39.9 12881816      978.        12.9 \n 8 Afghanistan Asia       1987    40.8 13867957      852.        13.9 \n 9 Afghanistan Asia       1992    41.7 16317921      649.        16.3 \n10 Afghanistan Asia       1997    41.8 22227415      635.        22.2 \n# ℹ 1,694 more rows\n```\n\n\n:::\n:::\n\n\nUseful for:\n\n-   adding an extra column containing a calculation\n\n-   combining with group_by() for grouped calculations\n\n-   updating a column which has mistakes\n\n-   converting a column to a different data type\n\nRemember:\n\n-   your new column is always added at the end of your tibble (data frame)\n\n-   the value to the left of the = is the new name for you column and could be called anything\n\n-   if you want to replace a column, the value to the left of the = must be exactly the same name as the column to replace\n\n#### **`summarise()`**\n\n**summarise() returns a new tibble (data frame) containing summary statistics based on what has been specified in the function.**\n\nIn the example below the summarise function has calculated the average life expectancy for the whole gapminder dataset by averaging all observations (or rows). On its own, summarise() is not so useful, but when combined with group_by() its use becomes apparent, see later examples.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngapminder %>%\n  summarise(avg_life_exp = mean(lifeExp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 1\n  avg_life_exp\n         <dbl>\n1         59.5\n```\n\n\n:::\n:::\n\n\nUseful for:\n\n-   combining with group_by() to perform grouped calculations\n\n#### **`group_by()`**\n\n**group_by() lets you choose how you want the variables in your dataset to be grouped so that you can perform operations (such as sum() or mean()) on these groups.**\n\nIn the example below we have grouped our data by the variable year. Notice that the output to this chunk of code looks no different to how it would look if we just ran gapminderwithout any grouping. This is because the effects of group_by() are only noticeable when we start performing operations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngapminder %>%\n  group_by(year)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1,704 × 6\n# Groups:   year [12]\n   country     continent  year lifeExp      pop gdpPercap\n   <fct>       <fct>     <int>   <dbl>    <int>     <dbl>\n 1 Afghanistan Asia       1952    28.8  8425333      779.\n 2 Afghanistan Asia       1957    30.3  9240934      821.\n 3 Afghanistan Asia       1962    32.0 10267083      853.\n 4 Afghanistan Asia       1967    34.0 11537966      836.\n 5 Afghanistan Asia       1972    36.1 13079460      740.\n 6 Afghanistan Asia       1977    38.4 14880372      786.\n 7 Afghanistan Asia       1982    39.9 12881816      978.\n 8 Afghanistan Asia       1987    40.8 13867957      852.\n 9 Afghanistan Asia       1992    41.7 16317921      649.\n10 Afghanistan Asia       1997    41.8 22227415      635.\n# ℹ 1,694 more rows\n```\n\n\n:::\n:::\n\n\nIn this next example we have combined group_by() with the summarise() command and now, instead of seeing an average life expectancy for the whole tibble (as in the example above), we see that life expectancy has been averaged within each year group.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngapminder %>%\ngroup_by(year) %>%\n  summarise(avg_life_exp = mean(lifeExp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 12 × 2\n    year avg_life_exp\n   <int>        <dbl>\n 1  1952         49.1\n 2  1957         51.5\n 3  1962         53.6\n 4  1967         55.7\n 5  1972         57.6\n 6  1977         59.6\n 7  1982         61.5\n 8  1987         63.2\n 9  1992         64.2\n10  1997         65.0\n11  2002         65.7\n12  2007         67.0\n```\n\n\n:::\n:::\n\n\nUseful for:\n\n-   combining with summarise()or mutate() for grouped calculations\n\n-   preparing summary statistics for plotting\n\n-   exploring values within groups in your data\n\nRemember:\n\n-   to use ungroup() if carrying out further data manipulations to avoid unexpected results, as by default, mutate() and summarise() silently retain the groupings.\n\n-   the value to the left of the = is the new name for your column and could be called anything\n\n#### **`left_join()`**\n\n**left_join() allows you to combine two datasets**\n\nIn the example below we are joining the gapminder tibble to another tibble we can access directly from the gapminder package, the country_codes data frame, in order to add the ISO country codes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngapminder %>%\n  left_join(country_codes)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nJoining with `by = join_by(country)`\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1,704 × 8\n   country     continent  year lifeExp      pop gdpPercap iso_alpha iso_num\n   <chr>       <fct>     <int>   <dbl>    <int>     <dbl> <chr>       <int>\n 1 Afghanistan Asia       1952    28.8  8425333      779. AFG             4\n 2 Afghanistan Asia       1957    30.3  9240934      821. AFG             4\n 3 Afghanistan Asia       1962    32.0 10267083      853. AFG             4\n 4 Afghanistan Asia       1967    34.0 11537966      836. AFG             4\n 5 Afghanistan Asia       1972    36.1 13079460      740. AFG             4\n 6 Afghanistan Asia       1977    38.4 14880372      786. AFG             4\n 7 Afghanistan Asia       1982    39.9 12881816      978. AFG             4\n 8 Afghanistan Asia       1987    40.8 13867957      852. AFG             4\n 9 Afghanistan Asia       1992    41.7 16317921      649. AFG             4\n10 Afghanistan Asia       1997    41.8 22227415      635. AFG             4\n# ℹ 1,694 more rows\n```\n\n\n:::\n:::\n\n\nUseful for:\n\n-   combining two sets of data which share an id (e.g. patient id, appointment id)\n\n-   adding in information from a lookup table (e.g. country codes, Health Board names)\n\nRemember:\n\n-   to watch out what happens to missing values\n\n-   to keep an eye on the number of observations in each tibble before and after joining\n\n-   to check which columns are being joined by\n\nOther functions for wrangling data and what they might be useful for:\n\n-   `arrange()` for sorting the values within a column\n\n-   `desc()` for indicating descending sort order when used within arrange()\n\n-   `str_replace()` for updating spelling mistakes in a column\n\n-   `paste()` for joining things together and adding new text\n\n-   `ymd()` for reading in dates in strange formats\n\n-   `factor()` for converting a variable to factor data type\n\n-   `fct_relevel()` for changing the order of factors\n\n-   `pivot_longer()` for reshaping your data if you have values in column headings\n\n-   `pivot_wider()` for reshaping your data if you have multiple variables in one column\n\n## Plotting and tables recap\n\nIn the examples below we provide a recap on how to use ggplot2 to build up layers on a plot. Included are examples of argument options which you might want to experiment with in your own plots. I rarely remember any of the argument specifics and always fine-tune my plots by pressing \\`F1\\` on the various functions I'm using and exploring the documentation (F1, or fn+F1 on some computers opens up the Help tab). Then it's a process of trial and error.\n\nComments are included before each new line or layer to describe what is happening.\n\n#### **The blank canvas**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Data we are sending to ggplot()\ngapminder %>%\n# lets create a plot\n ggplot(aes(    # specify the axes\n      x = year,\n      y = lifeExp))\n```\n\n::: {.cell-output-display}\n![](topic-3_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nRemember:\n\n-   that everything from now on needs + at end of line instead of %\\>%\n\n#### **Plot type**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngapminder %>%\n  ggplot(aes(x = year, y = lifeExp)) +\n  # specify type of plot: scatter with jitter\n  geom_jitter(\n    # colour life expectancy based on values\n    aes(colour = lifeExp),\n    # set \"alpha\" making points same transparency\n    alpha = 0.6,\n    # specify width of \"jitter\"\n    width = 0.5)\n```\n\n::: {.cell-output-display}\n![](topic-3_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nRemember:\n\n-   colour is specified *inside* the aes() function because we want it to be dependent on the values in the data\n\n-   alpha and width are specified *outside* the aes() function because we want to specify a fixed value for these arguments\n\n#### **Faceting**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngapminder %>%\n  ggplot(aes(x = year, y = lifeExp)) +\n  geom_jitter(aes(colour = lifeExp),\n              alpha = 0.6,\n              width = 0.5) +\n  # create muti-panle plot\n  facet_wrap(\n    # based on continent grouping\n    ~ continent)\n```\n\n::: {.cell-output-display}\n![](topic-3_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nUseful for:\n\n-   comparing values between different categories in your dataset\n\n#### **Including a second geom, e.g., geom_boxplot()**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngapminder %>%\n  ggplot(aes(x = year, y = lifeExp)) +\n  geom_jitter(aes(colour = lifeExp),\n              alpha = 0.6,\n              width = 0.5) +\n  facet_wrap(~ continent) +\n  # specify type of plot: boxplot\n  geom_boxplot(\n    # group by year (discrete) as currently \"int\" data type (continuous)\n    aes(group = year),\n    # set \"alpha\" so we can see jitter points underneath\n    alpha = 0.3,\n    # remove boxplot outliers as already present in \"jitter\" layer\n    outlier.shape = NA)\n```\n\n::: {.cell-output-display}\n![](topic-3_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nRemember:\n\n-   Depending on whether your variable is stored as a \"number\" or a \"character\" or a \"factor\" will determine how ggplot2 deals with it\n\n#### **Standard themes**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngapminder %>%\n  ggplot(aes(x = year, y = lifeExp)) +\n  geom_jitter(aes(colour = lifeExp),\n              alpha = 0.6,\n              width = 0.5) +\n  facet_wrap(~ continent) +\n  geom_boxplot(aes(group = year),\n               alpha = 0.3,\n               outlier.shape = NA) +\n  # choose a standard theme: dark\n  theme_dark()\n```\n\n::: {.cell-output-display}\n![](topic-3_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nUseful for:\n\n-   quickly changing how your plot looks by applying one of the built in themes: theme_bw() , theme_classic() , theme_dark() etc.\n\n## Making Tables\n\nTables are another important tool to have in your data analysis toolbox for communcating. As a general rule, when deciding between tables for graphs/plots:\n\n-   use **tables** when the display will be used to look up individual values or you want to compare individual values\n\n-   use **graphs** when the display will be used to reveal relatonships among whole sets of values or between variables\n\nTo make tables, we worked with the kable function and kableExtra package in R.\n\nThe general gt workflow includes 3 key steps:\n\n1.  wrangle your data for the table by either piping %\\>% the data or creating a new data object (tabledata \\<- data %\\>% mutate(...))\n\n2.  pass the wrangled data to the kable function %\\>% kable()\n\n3.  format the table object for presentation\n\n### **Step 1: Wrangle data for the table**\n\nLets say we are interested in average life expectancy in Africa, Asia, and Oceania in the years 1952, 1972, 1992, and 2002\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(knitr)\nlibrary(kableExtra)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'kableExtra'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n```\n\n\n:::\n\n```{.r .cell-code}\ntabledata <- gapminder %>%\n  group_by(year, continent) %>%\n  summarise(avg_life_exp = mean(lifeExp)) %>% \n  filter(continent %in% c(\"Africa\", \"Asia\", \"Oceania\"),\n         year %in% c(1952, 1972, 1992, 2002))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'year'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n:::\n\n\n### **Step 2: Create the kable table object**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntabledata %>% kable()\n```\n\n::: {.cell-output-display}\n\n\n| year|continent | avg_life_exp|\n|----:|:---------|------------:|\n| 1952|Africa    |     39.13550|\n| 1952|Asia      |     46.31439|\n| 1952|Oceania   |     69.25500|\n| 1972|Africa    |     47.45094|\n| 1972|Asia      |     57.31927|\n| 1972|Oceania   |     71.91000|\n| 1992|Africa    |     53.62958|\n| 1992|Asia      |     66.53721|\n| 1992|Oceania   |     76.94500|\n| 2002|Africa    |     53.32523|\n| 2002|Asia      |     69.23388|\n| 2002|Oceania   |     79.74000|\n\n\n:::\n:::\n\n\n### **Step 3: Format the table for presentation**\n\nHow you decide to format and customise your table visually is a stylistic and personal choice. However, there are a few key principles to keep in mind:\n\n-   you should always change the name of your variables to be meaingful to stakeholders who are not familiar with your data - that is, do not keep column names the same as they are called in your dataset\n\n-   generally, it is a good idea to have a title on each table\n\n-   for reproducibility, it is a good idea to include the data source if you are using an openly available dataset\n\n-   be consistent: use capital or lower case letters in a consistent way\n\n-   format numbers in an interpretable way (generally speaking, you do not need to include more than 2 or 3 decimal places)\n\nBelow is one way you could format the table for presentation:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntabledata %>%\n  kable(col.names = c(\"Year\", \"Continent\", \"Average Life Expectancy\"),\n        align = \"clc\",\n        digits = 2,\n        caption = \"Life Expectancy in Africa, Asia, and Oceania: Data from 1952, 1972, 1992, and 2002\") %>%\n  kable_styling(\"striped\", full_width = FALSE) %>%\n  footnote(general = \"Data from the gapminder dataset\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n<caption>Life Expectancy in Africa, Asia, and Oceania: Data from 1952, 1972, 1992, and 2002</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> Year </th>\n   <th style=\"text-align:left;\"> Continent </th>\n   <th style=\"text-align:center;\"> Average Life Expectancy </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> 1952 </td>\n   <td style=\"text-align:left;\"> Africa </td>\n   <td style=\"text-align:center;\"> 39.14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 1952 </td>\n   <td style=\"text-align:left;\"> Asia </td>\n   <td style=\"text-align:center;\"> 46.31 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 1952 </td>\n   <td style=\"text-align:left;\"> Oceania </td>\n   <td style=\"text-align:center;\"> 69.25 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 1972 </td>\n   <td style=\"text-align:left;\"> Africa </td>\n   <td style=\"text-align:center;\"> 47.45 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 1972 </td>\n   <td style=\"text-align:left;\"> Asia </td>\n   <td style=\"text-align:center;\"> 57.32 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 1972 </td>\n   <td style=\"text-align:left;\"> Oceania </td>\n   <td style=\"text-align:center;\"> 71.91 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 1992 </td>\n   <td style=\"text-align:left;\"> Africa </td>\n   <td style=\"text-align:center;\"> 53.63 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 1992 </td>\n   <td style=\"text-align:left;\"> Asia </td>\n   <td style=\"text-align:center;\"> 66.54 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 1992 </td>\n   <td style=\"text-align:left;\"> Oceania </td>\n   <td style=\"text-align:center;\"> 76.94 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 2002 </td>\n   <td style=\"text-align:left;\"> Africa </td>\n   <td style=\"text-align:center;\"> 53.33 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 2002 </td>\n   <td style=\"text-align:left;\"> Asia </td>\n   <td style=\"text-align:center;\"> 69.23 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 2002 </td>\n   <td style=\"text-align:left;\"> Oceania </td>\n   <td style=\"text-align:center;\"> 79.74 </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr><td style=\"padding: 0; \" colspan=\"100%\"><span style=\"font-style: italic;\">Note: </span></td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Data from the gapminder dataset</td></tr>\n</tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n## Combined Example\n\nIn [this example](/documents/week-4/Combined_example.Rmd) you can see a simple R Markdown document without any narrative text added yet, just the YAML then a series of code chunks outlining the various stages in the data analysis process.\n\nWhich when knitted to a pdf document looks like this:\n\nPDF!\n\nThe next step would be to add in narrative text, creating a comprehensive analysis.\n\n## Optional: Data Engagement & Data Controversies\n\nCritically review the arguments posed in this article:\n\nMittelstadt B (2019) [Principles alone cannot guarantee ethical AI](https://doi.org/10.1038/s42256-019-0114-4). Nat Mach Intell 1, 501--507.\n\n------------------------------------------------------------------------\n",
    "supporting": [
      "topic-3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}